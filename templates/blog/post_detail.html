{% extends "base.html" %}
{% load crispy_forms_filters %}
{% load crispy_forms_tags %}

{% block content %}
  <div class="container my-4">
    <!-- Пост -->
    <div class="mb-4">
      <h2>{{ object.title }}</h2>
      <p class="text-muted mb-1">
        {{ object.owner.username }}
        <span class="text-secondary">at {{ object.created_time|date:"M. d, Y, g:i a" }}</span>
      </p>
      <div class="lead">{{ object.content|safe }}</div>
    </div>

    <!-- Коментарі -->
    <h5>{{ object.commentaries.count }} comment{{ object.commentaries.count|pluralize }}</h5>
    {% if object.commentaries.exists %}
      {% for comment in object.commentaries.all %}
        <div class="border rounded p-2 mb-2">
          <strong>{{ comment.user.username }}</strong>
          <small class="text-muted">{{ comment.created_time|date:"M. d, Y, g:i a" }}</small>
          <p class="mb-0">{{ comment.content }}</p>
        </div>
      {% endfor %}
    {% else %}
      <p class="text-muted">No comments yet.</p>
    {% endif %}

    <!-- Форма -->
    {% if user.is_authenticated %}
      <h6>Add a new comment</h6>
      <form method="post">
        {% csrf_token %}
        {{ form|crispy }}
        <button type="submit" class="btn btn-primary">Add Comment</button>
      </form>
      </div>
    {% else %}
      <div class="alert alert-info">
        You need to be logged in to add a comment.
      </div>
    {% endif %}

  <!-- Кнопка назад -->
  <div class="mt-4">
    <a href="{% url 'blog:index' %}" class="btn btn-outline-secondary mt-3">← Back to Posts</a>
  </div>

{% endblock %}
